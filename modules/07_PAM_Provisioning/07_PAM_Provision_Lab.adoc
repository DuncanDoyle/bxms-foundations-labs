:scrollbar:
:data-uri:
:toc2:
:pam_template: link:https://raw.githubusercontent.com/gpe-mw-training/bxms_decision_mgmt_foundations_lab/master/resources/rhdm7-only.yaml[Process Automation Manager template]

= Process Automation Manager Provision Lab


.Goals
* Provision the Process Automation Manager in an OpenShift environment

:numbered:

== Overview

The Red Hat Process Automation Manager product can be provisioned in either of the following environments:

. Any combination of JVM, OS and application container detailed in the link:https://access.redhat.com/articles/3354301[Red Hat Process Automation Manager Support Configurations document].
+
The installation procedure for this approach can be found in the link:https://access.redhat.com/documentation/en-us/red_hat_decision_manager/7.0/html-single/installing_red_hat_decision_manager_on_premise/index[supported product documentation].
+
This lab does not discuss this installation approach.
. In an OpenShift Container Platform environment
+
The focus of this lab is on this approach.
+
Related documentation on this installation procedure can also be found link:https://access.redhat.com/documentation/en-us/red_hat_decision_manager/7.0/html-single/deploying_red_hat_decision_manager_on_red_hat_openshift_container_platform/index[here].

The Process Automation Manager product will be provisioned in a single remote Openshift project.
For the purpose of this lab, this single remote OpenShift project is provided to you; you do not need to install the OpenShift Container Platform.

== Process Automation Manager template

The Red Hat Process Automation Manager product includes a variety of OpenShift templates that define all of the artifacts to be provisioned for a Process Automation Manager deployment.

=== PAM Template Overview

Details of the list of templates offered are as follows:

. *rhpam70-authoring.yaml*
+
Description: An example of a recommended authoring environment for most customers where scalability and reliability requirements do not rise to levels justifying a high-availability setup.
Technical Content: Single replica of business central configured to use a persistent volume, set up to tightly integrate with an instance of the KIE server, using business central as its Maven repo and persisting process data to H2, backed by a persistent volume.

. *rhpam70-authoring-ha.yaml*
+
Description: An example of a recommended highly-available authoring environment for most customers requiring significant scalability and reliability.
Technical Content: Two default replicas of business central running on an EAP cluster, using elasticsearch and AMQ, and configured with a shared persistent volume, set up to tightly integrate with two replicas of the KIE server, using business central as its Maven repo and persisting process data to PostgreSQL.

. *rhpam70-sit.yaml*
+
Description: An example of a recommended integration testing environment for most customers.
Technical Content: Single replica of business central monitoring, connected to a smart router, configured for two distinct sets of KIE servers, configured with an external Maven repo and  persisting to different instances of PostgreSQL.

. *rhpam70-prod.yaml*
+
Description: An example of a recommended production environment, with the expectation that a majority of current customers would run something very similar.
Technical Content: Three default replicas of business central monitoring, configured for single sign-on with RH-SSO integration, connected to two replicas of the smart router, configured for two distinct sets of KIE servers, pointing to an external Maven repo and persisting to different instances of PostgreSQL.

. *rhpam70-prod-immutable-monitor.yaml*
+
Description: An example of a recommended production environment for an expected minority of customers who wish to run immutable containers that cannot be managed.
Technical Content: Three default replicas of business central monitoring, configured for single sign-on with RH-SSO integration, connected to two replicas of the smart router, configured for connection to distinct sets of S2I KIE server images using container-local maven, that can be created through an associated template.

. *rhpam70-prod-immutable-kieserver.yaml*
+
Description: An immutable KIE server used optionally connecting to a monitoring console
Technical Content: Two replica of KIE server using s2i to generate container-local maven data and persisting to PostgreSQL. May optionally point to a smart router and/or monitoring.

. *rhpam70-trial-ephemeral.yaml*
+
Description: A short-living trial environment that can be quickly and easily installed
Technical Content: Business central with ephemeral local git tightly coupled to a KIE server using ephemeral H2 database and pointing to business central as its Maven service.

. *rhpam70-kieserver-postgresql.yaml*
+
Description: An example of a managed KIE server used with a monitoring console
Technical Content: Single replica of KIE server with required configuration to use an external Maven service, and included PostgreSQL database. May optionally point to a smart router.

. *rhpam70-kieserver-mysql.yaml*
+
Description: An example of a managed KIE server used with a monitoring console
Technical Content: Single replica of KIE server with required configuration to use an external Maven service, and included MySQL database. May optionally point to a smart router.

. *rhpam70-kieserver-externaldb.yaml*
+
Description: An example of a managed KIE server used with a monitoring console
Technical Content: Single replica of KIE server with required configuration to use an external Maven service, and required configuration to persist to an external database. May optionally point to a smart router.

These templates can be found link:https://github.com/jboss-container-images/rhpam-7-openshift-image/tree/7.0.2.GA/templates[here].

== Use your provisioned Openshift project to add an application

In this section of the lab, you will add a new application for the Red Hat Process Automation Manager in your existing openshift environment provisioned during the first lab of this course.

. In your browser, navigate to the master host of your openshift environment:

+
image::images/ocp-home.png[]

. From the catalog header menu, select **Import YAML/JSON**.

+
image::images/click_yaml.png[]
. Populate the form as follows:
.. In the text box, paste the contents of the link:https://raw.githubusercontent.com/jboss-container-images/rhpam-7-openshift-image/7.0.2.GA/rhpam70-image-streams.yaml[image-streams file].
. Once the `Create` button is enabled, click it, and confirm the resource creation.

+
image::images/import-is.png[]

+
[NOTE]
====
Notice here the **Add to project** read only field, you will use this value later, note this value as `your Openshift provisioned project name`
====

. Repeat the import operation for the link:https://raw.githubusercontent.com/jboss-container-images/rhpam-7-openshift-image/7.0.2.GA/templates/rhpam70-trial-ephemeral.yaml[rhpam70-trial-ephemeral template].
.. At the `Add Template` pop-up, ensure the `Process the Template` checkbox is checked and then click `Continue`

+
image:images/import-template.png[]

. Change the values of the following template parameters as follows:
.. *ImageStream namespace*: <use your openshift provisioned project name> _example:bxms-pam-f57b_

+
image:images/import-template-parameters.png[]

. Click `Create`, and confirm creation.

== Verify

. Return to the homepage of your `Manually Provisioned Process Automation Manager` project.
. Notice that in your `Overview` a new application **rhpam70-ephemeral** has been created
+
image::images/trial-ephemeral-app.png[]
. Once the deployments for the application complete, you should be ready to access the business central and kie server routes like in the first lab of the course; the difference here is that your adminUser password will be `RedHat`

== Conclusion
Congratulations, during this lab you provisioned the Process Automation Manager product in an Openshift Container Platform environment.
